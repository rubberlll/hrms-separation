"use strict";(self.webpackChunkmy_pra=self.webpackChunkmy_pra||[]).push([[577],{8577:(e,t,a)=>{a.r(t),a.d(t,{default:()=>p});var r=a(6540),l=a(4054),n=a(3532),s=a(2702),m=a(2941),i=a(9957),o=a(5739),c=a(5423),u=a(6945),d=a(9298);const p=()=>{const[e,t]=(0,r.useState)([]),[a,p]=(0,r.useState)(!1),[y,A]=(0,r.useState)(!1),[E,h]=(0,r.useState)(!1),[w,v]=(0,r.useState)(null),[k]=l.A.useForm(),[I]=l.A.useForm(),[g]=l.A.useForm(),[f,b]=(0,r.useState)([]),C=async()=>{p(!0);try{const e=await d.A.get("/users");t(e.data.data),b(e.data.data)}catch(e){console.error("获取用户列表失败:",e),n.Ay.error("获取用户列表失败")}finally{p(!1)}};(0,r.useEffect)((()=>{C()}),[]);const O=[{title:"用户名",dataIndex:"username",key:"username",width:120},{title:"角色",dataIndex:"role",key:"role",width:100,render:e=>({admin:"管理员",hr:"HR",employee:"员工",user:"普通用户"}[e]||e)},{title:"邮箱",dataIndex:"email",key:"email",width:180,ellipsis:!0},{title:"电话",dataIndex:"phone",key:"phone",width:120,render:e=>e||"-"},{title:"部门",dataIndex:"department",key:"department",render:e=>e||"-"},{title:"状态",dataIndex:"status",key:"status",render:e=>({active:"激活",inactive:"禁用",pending:"待审核"}[e]||e)},{title:"入职日期",dataIndex:"entryDate",key:"entryDate",render:e=>e||"-"},{title:"雇佣类型",dataIndex:"employmentType",key:"employmentType",render:e=>e||"-"},{title:"创建时间",dataIndex:"createdAt",key:"createdAt",render:e=>new Date(e).toLocaleString()},{title:"操作",key:"action",width:200,render:(e,t)=>r.createElement(s.A,{size:"middle"},r.createElement(m.Ay,{type:"link",onClick:()=>{return v(e=t),k.setFieldsValue({username:e.username,role:e.role,status:e.status}),void A(!0);var e}},"修改权限"),r.createElement(m.Ay,{type:"link",onClick:()=>(v(t),I.resetFields(),void h(!0))},"重置密码"))}];return r.createElement("div",{className:"permission-management-container"},r.createElement("h1",null,"权限管理"),r.createElement("div",{style:{marginBottom:16}},r.createElement(l.A,{form:g,layout:"inline",onFinish:t=>{const{username:a,role:r}=t;let l=[...e];a&&(l=l.filter((e=>e.username.toLowerCase().includes(a.toLowerCase())))),r&&(l=l.filter((e=>e.role===r))),b(l)}},r.createElement(l.A.Item,{name:"username",label:"用户名"},r.createElement(i.A,{placeholder:"请输入用户名",allowClear:!0})),r.createElement(l.A.Item,{name:"role",label:"角色"},r.createElement(o.A,{placeholder:"请选择角色",allowClear:!0,style:{width:150}},r.createElement(o.A.Option,{value:"admin"},"管理员"),r.createElement(o.A.Option,{value:"hr"},"HR"),r.createElement(o.A.Option,{value:"employee"},"员工"),r.createElement(o.A.Option,{value:"user"},"普通用户"))),r.createElement(l.A.Item,null,r.createElement(m.Ay,{type:"primary",htmlType:"submit"},"搜索")),r.createElement(l.A.Item,null,r.createElement(m.Ay,{onClick:()=>{g.resetFields(),b(e)}},"重置")))),r.createElement(c.A,{columns:O,dataSource:f,rowKey:e=>e.id||e.key,loading:a,pagination:{pageSize:10,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","50"],showTotal:e=>`共 ${e} 条记录`},scroll:{x:1300},bordered:!0}),r.createElement(u.A,{title:"修改用户权限",open:y,onCancel:()=>A(!1),footer:null},r.createElement(l.A,{form:k,layout:"vertical",onFinish:async e=>{if(w)try{await d.A.put(`/users/${w.id||w.key}`,{role:e.role,status:e.status}),n.Ay.success("权限更新成功"),A(!1),C()}catch(e){console.error("更新权限失败:",e),n.Ay.error("更新权限失败")}}},r.createElement(l.A.Item,{name:"username",label:"用户名"},r.createElement(i.A,{disabled:!0})),r.createElement(l.A.Item,{name:"role",label:"角色",rules:[{required:!0,message:"请选择角色"}]},r.createElement(o.A,null,r.createElement(o.A.Option,{value:"admin"},"管理员"),r.createElement(o.A.Option,{value:"hr"},"HR"),r.createElement(o.A.Option,{value:"employee"},"员工"),r.createElement(o.A.Option,{value:"user"},"普通用户"))),r.createElement(l.A.Item,{name:"status",label:"状态",rules:[{required:!0,message:"请选择状态"}]},r.createElement(o.A,null,r.createElement(o.A.Option,{value:"active"},"激活"),r.createElement(o.A.Option,{value:"inactive"},"禁用"),r.createElement(o.A.Option,{value:"pending"},"待审核"))),r.createElement(l.A.Item,null,r.createElement(m.Ay,{type:"primary",htmlType:"submit"},"保存")))),r.createElement(u.A,{title:"重置用户密码",open:E,onCancel:()=>h(!1),footer:null},r.createElement(l.A,{form:I,layout:"vertical",onFinish:async e=>{if(w)try{await d.A.put("/users",{userId:w.id||w.key,password:e.password}),n.Ay.success("密码更新成功"),h(!1)}catch(e){console.error("更新密码失败:",e),n.Ay.error("更新密码失败")}}},r.createElement(l.A.Item,{name:"password",label:"新密码",rules:[{required:!0,message:"请输入新密码"},{min:6,message:"密码长度不能少于6个字符"}]},r.createElement(i.A.Password,null)),r.createElement(l.A.Item,{name:"confirmPassword",label:"确认密码",dependencies:["password"],rules:[{required:!0,message:"请确认密码"},({getFieldValue:e})=>({validator:(t,a)=>a&&e("password")!==a?Promise.reject(new Error("两次输入的密码不一致")):Promise.resolve()})]},r.createElement(i.A.Password,null)),r.createElement(l.A.Item,null,r.createElement(m.Ay,{type:"primary",htmlType:"submit"},"保存")))))}}}]);
//# sourceMappingURL=577.bundle.js.map