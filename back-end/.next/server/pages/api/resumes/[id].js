"use strict";(()=>{var e={};e.id=132,e.ids=[132],e.modules={9344:e=>{e.exports=require("jsonwebtoken")},1185:e=>{e.exports=require("mongoose")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},5764:(e,t,a)=>{a.r(t),a.d(t,{config:()=>c,default:()=>m,routeModule:()=>f});var s={};a.r(s),a.d(s,{default:()=>i});var r=a(1802),d=a(7153),n=a(6249),u=a(5011),o=a(4861),l=a(9529);async function handler(e,t){let{id:a}=e.query,s=e.user;try{if(await (0,u.Z)(),"GET"===e.method){let e=await o.Z.findById(a).populate("userId","username email").populate("jobId","title department");if(!e)return t.status(404).json({code:404,message:"简历不存在",data:null});if("admin"!==s.role&&"hr"!==s.role&&e.userId._id.toString()!==s.userId)return t.status(403).json({code:403,message:"无权访问此简历",data:null});return t.status(200).json({code:200,message:"获取简历详情成功",data:e})}if("PUT"===e.method){if("admin"!==s.role&&"hr"!==s.role)return t.status(403).json({code:403,message:"无权更新简历状态",data:null});let{status:r}=e.body;if(!r)return t.status(400).json({code:400,message:"请提供状态字段",data:null});let d=await o.Z.findByIdAndUpdate(a,{status:r},{new:!0});if(!d)return t.status(404).json({code:404,message:"简历不存在",data:null});return t.status(200).json({code:200,message:"更新简历状态成功",data:d})}if("DELETE"===e.method){let e=await o.Z.findById(a);if(!e)return t.status(404).json({code:404,message:"简历不存在",data:null});if("admin"!==s.role&&e.userId.toString()!==s.userId)return t.status(403).json({code:403,message:"无权删除此简历",data:null});return await o.Z.findByIdAndDelete(a),t.status(200).json({code:200,message:"删除简历成功",data:null})}return t.status(405).json({code:405,message:"方法不允许",data:null})}catch(e){return console.error(e),t.status(500).json({code:500,message:"服务器错误",data:null})}}let i=(0,l.l)(handler),m=(0,n.l)(s,"default"),c=(0,n.l)(s,"config"),f=new r.PagesAPIRouteModule({definition:{kind:d.x.PAGES_API,page:"/api/resumes/[id]",pathname:"/api/resumes/[id]",bundlePath:"",filename:""},userland:s})}};var t=require("../../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),a=t.X(0,[222,529,53],()=>__webpack_exec__(5764));module.exports=a})();