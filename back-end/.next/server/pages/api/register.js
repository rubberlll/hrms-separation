"use strict";(()=>{var e={};e.id=553,e.ids=[553],e.modules={1185:e=>{e.exports=require("mongoose")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},7618:e=>{e.exports=import("bcryptjs")},508:(e,s,t)=>{t.a(e,async(e,a)=>{try{t.r(s),t.d(s,{config:()=>d,default:()=>c,routeModule:()=>l});var r=t(1802),n=t(7153),i=t(6249),u=t(1876),o=e([u]);u=(o.then?(await o)():o)[0];let c=(0,i.l)(u,"default"),d=(0,i.l)(u,"config"),l=new r.PagesAPIRouteModule({definition:{kind:n.x.PAGES_API,page:"/api/register",pathname:"/api/register",bundlePath:"",filename:""},userland:u});a()}catch(e){a(e)}})},1876:(e,s,t)=>{t.a(e,async(e,a)=>{try{t.r(s),t.d(s,{default:()=>handler});var r=t(8444),n=t(5011),i=e([r]);async function handler(e,s){if("POST"!==e.method)return s.status(405).json({success:!1,message:"只允许POST请求"});try{await (0,n.Z)();let{username:t,password:a,email:i}=e.body;if(!t||!a||!i)return s.status(400).json({success:!1,message:"用户名、密码和邮箱为必填项"});let u=await r.Z.findOne({username:t});if(u)return s.status(400).json({success:!1,message:"用户名已被使用"});let o=await r.Z.findOne({email:i});if(o)return s.status(400).json({success:!1,message:"邮箱已被注册"});let c=new r.Z({username:t,password:a,email:i,role:"user",status:"pending"});return await c.save(),s.status(201).json({code:201,message:"注册成功，请登录",data:null})}catch(e){return console.error("注册API错误:",e),s.status(500).json({success:!1,message:"服务器错误，请稍后再试"})}}r=(i.then?(await i)():i)[0],a()}catch(e){a(e)}})}};var s=require("../../webpack-api-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),t=s.X(0,[222,227],()=>__webpack_exec__(508));module.exports=t})();